import{d as O,r as w,c as L,a as k,o as I,b as j,e as N,f as l,g as B,E as R,h as D,i as C,N as p,j as $,k as M}from"./vendor.8b29c9a1.js";const V=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}};V();var q=(e,t)=>{const o=e.__vccOpts||e;for(const[n,s]of t)o[n]=s;return o};const U=O({name:"App",setup(){return{isCollapse:w(!1),route:{path:"/about"},handleOpen:(s,r)=>{console.log(s,r)},handleClose:(s,r)=>{console.log(s,r)}}}});function K(e,t,o,n,s,r){const i=k("router-view");return I(),L(i)}var J=q(U,[["render",K]]);const W="modulepreload",E={},F="/",u=function(t,o){return!o||o.length===0?t():Promise.all(o.map(n=>{if(n=`${F}${n}`,n in E)return;E[n]=!0;const s=n.endsWith(".css"),r=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${r}`))return;const i=document.createElement("link");if(i.rel=s?"stylesheet":W,s||(i.as="script",i.crossOrigin=""),i.href=n,document.head.appendChild(i),s)return new Promise((c,T)=>{i.addEventListener("load",c),i.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>t())};let _=[{component:"layout/index",redirect:{name:"dashboard"},meta:{title:"\u4EEA\u8868\u76D8",icon:"el-icon-data-analysis"},children:[{name:"dashboard",component:"dashboard/index",meta:{title:"\u4EEA\u8868\u76D8",icon:"el-icon-data-analysis"}}]},{name:"goods",component:"layout/index",meta:{title:"\u83DC\u54C1\u7BA1\u7406",icon:"el-icon-data-analysis"},children:[{component:"goods/list",meta:{title:"\u83DC\u54C1\u5217\u8868"}},{component:"goods/add",meta:{title:"\u65B0\u589E\u83DC\u54C1"}},{component:"goods/set",meta:{title:"\u65B0\u589E\u83DC\u54C11"}}]},{name:"image",component:"layout/index",meta:{title:"\u4E91\u76F8\u518C",icon:"el-icon-picture"},children:[{meta:{title:"\u4E91\u76F8\u518C",icon:"el-icon-picture"},component:"image/index"}]},{meta:{title:"\u7BA1\u7406\u5458",icon:"el-icon-data-analysis"},component:"admin/index"},{component:"login/index",meta:{hidden:!0}},{path:"/:pathMatch(.*)*",redirect:{name:"dashboard"},meta:{title:"404",hidden:!0}}];function H(){return A(_),console.log(_),_}const X={"/src/views/admin/index.vue":()=>u(()=>import("./index.abffbdc1.js"),["assets/index.abffbdc1.js","assets/vendor.8b29c9a1.js"]),"/src/views/dashboard/index.vue":()=>u(()=>import("./index.f2397aa6.js"),["assets/index.f2397aa6.js","assets/vendor.8b29c9a1.js"]),"/src/views/goods/add.vue":()=>u(()=>import("./add.8704f25b.js"),["assets/add.8704f25b.js","assets/add.2907d2ba.css","assets/vendor.8b29c9a1.js","assets/Plus.8414c90e.js"]),"/src/views/goods/list.vue":()=>u(()=>import("./list.0446bc06.js"),["assets/list.0446bc06.js","assets/vendor.8b29c9a1.js"]),"/src/views/goods/set.vue":()=>u(()=>import("./set.c1d8b721.js"),["assets/set.c1d8b721.js","assets/set.ba7442f7.css","assets/vendor.8b29c9a1.js","assets/Plus.8414c90e.js"]),"/src/views/image/index.vue":()=>u(()=>import("./index.09dccd5e.js"),["assets/index.09dccd5e.js","assets/index.1d42364b.css","assets/vendor.8b29c9a1.js"]),"/src/views/layout/index.vue":()=>u(()=>import("./index.da11f4f5.js"),["assets/index.da11f4f5.js","assets/index.d5e58783.css","assets/vendor.8b29c9a1.js"]),"/src/views/login/index.vue":()=>u(()=>import("./index.9664b17e.js"),["assets/index.9664b17e.js","assets/index.fd0fa590.css","assets/vendor.8b29c9a1.js"])};function A(e){for(let t=0;t<e.length;t++){if(!e[t].component)return;let o=Y(e[t].component);e[t].name=e[t].name||o.replace(/\//g,"_"),e[t].path=e[t].path||`/${o}`,e[t].component=X[`/src/views/${e[t].component}.vue`],e[t].children&&e[t].children.length>0&&A(e[t].children)}}function Y(e){let t=e.lastIndexOf("/");return e.substring(t+1,e.length)==="index"?e.substring(t,-1):e}var z=H();const d=z,h=[],a=j({history:N(),routes:d}),x="Admin-Token";function b(){return l.get(x)}function G(e){return l.set(x,e)}let v;v="https://xiafeng-1731703-1301297803.ap-shanghai.run.tcloudbase.com";console.log(v,"BASE_RUL");const g=B.create({baseURL:v,timeout:5e3});g.interceptors.request.use(e=>(m.getters.token&&(e.headers["X-Token"]=b()),e),e=>(console.log(e),Promise.reject(e)));g.interceptors.response.use(e=>{const t=e.data;return console.log("axios-response",t),t.code!==0?(R({message:t.message||"Error",type:"error",duration:5*1e3}),(t.code===50008||t.code===50012||t.code===50014)&&D.confirm("You have been logged out, you can cancel to stay on this page, or log in again","Confirm logout",{confirmButtonText:"Re-Login",cancelButtonText:"Cancel",type:"warning"}).then(()=>{m.dispatch("user/resetToken").then(()=>{location.reload()})}),Promise.reject(new Error(t.message||"Error"))):t},e=>(console.error(e),R({message:e.message,type:"error",duration:5*1e3}),Promise.reject(e)));function Q(e){return g({url:"/signin",method:"post",data:e})}const Z={token:b(),name:"",avatar:"",introduction:"",roles:[]},ee={getName(e){return e.name}},te={setName(e,t){e.name=t},SET_TOKEN(e,t){e.token=t}},oe={loginByUsername({commit:e},t){const{username:o,password:n}=t;return new Promise((s,r)=>{Q({username:o.trim(),password:n}).then(i=>{const{token:c}=i;console.log("token:",c),e("SET_TOKEN",c),G(c),s()}).catch(i=>{r(i)})})}};var se={namespaced:!0,state:Z,getters:ee,mutations:te,actions:oe};const ne={namespaced:!0,state:{sidebar:{opened:l.get("sidebarStatus")?!!l.get("sidebarStatus"):!0,withoutAnimation:!1},device:"desktop"},mutations:{toggle_sidebar:e=>{e.sidebar.opened=!e.sidebar.opened,e.sidebar.withoutAnimation=!1,e.sidebar.opened?l.set("sidebarStatus",1):l.set("sidebarStatus",0)},close_sidebar:(e,t)=>{l.set("sidebarStatus",0),e.sidebar.opened=!1,e.sidebar.withoutAnimation=t},toggle_device:(e,t)=>{e.device=t}},actions:{toggleSideBar({commit:e}){e("toggle_sidebar")},closeSideBar({commit:e},{widthoutAnimation:t}){e("close_sidebar",t)},toggleDevice({commit:e},t){e("toggle_device",t)}},getters:{getSidebarState(e){return e.sidebar.opened},getSidebarAnimation(e){return e.sidebar.withoutAnimation},getDeviceState(e){return e.device}}},y={queryAuthedPermission:"/api/auth/permission/routes",queryPermissions:"/api/auth/permission/permissions"};class P{static postAuthPermission(t){return g({url:y.queryAuthedPermission,method:"POST",json:!0,data:t}).then(o=>o.status===0?Promise.resolve(o):Promise.reject(o))}static postPermissions(t){return g({url:y.queryPermissions,method:"POST",json:!0,data:t}).then(o=>o.status===0?Promise.resolve(o):Promise.reject(o))}}const re=localStorage.getItem("role")||"",ie={namespaced:!0,state:{roles:re,permissions:[],accessRoutes:d,routes:d,authedRoutes:[]},mutations:{setRoles:(e,{roleName:t})=>{e.roles=t,console.log(e.roles)},setAccessRoutes:(e,t)=>{e.accessRoutes=d.concat(t)},setRoutes:(e,t)=>{e.routes=d.concat(t)},setAuthedRoutes:(e,t=[])=>{e.authedRoutes=t,localStorage.setItem("authedRoutes",JSON.stringify(t))},setPermissions:(e,t=[])=>{e.permissions=t}},actions:{getPermissonRoutes({commit:e},t){const o={roleName:t.roleName};P.postAuthPermission(o).then(n=>{const{authedRoutes:s}=n.data;e("setAuthedRoutes",s);const r=[];for(const i of s)for(const c of h)c.path===i&&r.push(c);a.isReady().then(()=>{r.forEach(i=>{const c=i.name;a.hasRoute(c)||a.addRoute(i)}),a.options.routes=d.concat(h),console.log(a),e("setAccessRoutes",r)})})},getPermissions({commit:e}){P.postPermissions({}).then(t=>{const{permissions:o}=t.data;e("setPermissions",o)})},getRoutes({commit:e}){if(localStorage.getItem("authedRoutes")){const t=JSON.parse(localStorage.getItem("authedRoutes")),o=[];for(const n of t)for(const s of h)s.path===n&&o.push(s);o.forEach(n=>{const s=n.name;a.hasRoute(s)||a.addRoute(n)})}e("setRoutes",h)},getPermissonRoles({commit:e},t){localStorage.setItem("role",t.roleName),e("setRoles",t)}},getters:{getAccessRoutes(e){return e.routes},authedRoutes(e){return e.authedRoutes},getRoles(e){return e.roles},getPermission(e){return e.permissions}}},ae={namespaced:!0,state:{tabsOption:[{route:"/dashboard",title:"\u4EEA\u8868\u76D8",name:"dashboard"}],currentIndex:"dashboard",breadcrumbList:[]},mutations:{ADD_TAB:(e,t)=>{e.tabsOption.push(t)},DELETE_TAB:(e,t)=>{const o=e.tabsOption.findIndex(n=>n.route===t);e.tabsOption.splice(o,1)},SET_TAB:(e,t)=>{e.currentIndex=t}},actions:{},getters:{getCurrentIndex(e){return e.currentIndex},getTabsOption(e){return e.tabsOption}}},ce=C({modules:{user:se,appModule:ne,permissionModule:ie,tabModule:ae}});var m=ce;p.configure({showSpinner:!1});const ue=["/login","/auth-redirect"];a.beforeEach(async(e,t,o)=>{!(m.getters["tabModule/getTabsOption"].findIndex(i=>i.route===e.path)>-1)&&!e.meta.hidden&&m.commit("tabModule/ADD_TAB",{route:e.path,title:e.meta.title,name:e.name}),m.commit("tabModule/SET_TAB",e.path),p.start(),b()?e.path==="/login"?(o("/"),p.done()):o():ue.indexOf(e.path)!==-1?(console.log("whiteList"),o()):(o(`/login?redirect=${e.path}`),p.done())});a.afterEach(()=>{p.done()});const S=$(J);var f=window.location.href;f=f.split(window.location.host)[1];console.log("url",f);a.push(f);S.use(a).use(m).use(M);a.isReady().then(()=>S.mount("#app"));export{q as _};
